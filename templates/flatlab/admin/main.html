{% extends 'flatlab/admin/base.html' %}
{% load staticfiles %}

{% block head %}
{{ block.super }}
<style>
.timeline{
  table-layout:auto;
}
.timeline-item:before, .timeline-item.alt:after {
  display:table-cell;
  width:10%;
}
.timeline-desk{
  width:90%;
}
.timeline:before {
  left: 10%;
}
.timeline-desk a{
  color:#39B6AE;
}
@media (max-width:670px) {
  .timeline-item:before, .timeline-item.alt:after {
    width:20%;
  }
  .timeline-desk{
    width:80%;
  }
  .timeline:before {
    left: 20%;
  }
}
@media (max-width:380px) {
  .timeline-item:before, .timeline-item.alt:after {
    width:25%;
  }
  .timeline-desk{
    width:75%;
  }
  .timeline:before {
    left: 25%;
  }
}
</style>
{% endblock %}

{% block body %}
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">
              
              <!--tab nav start-->
              <section class="panel">
                  <header class="panel-heading tab-bg-dark-navy-blue ">
                      <ul class="nav nav-tabs">
                            {% for i in dates %}
                                {% if forloop.counter <= 5 %}
                                    {% if forloop.counter == 1 %}
                                        <li class="active" id="date-tab-{{ forloop.counter }}">
                                    {% else %}      
                                        <li class="" id="date-tab-{{ forloop.counter }}">
                                    {% endif %}
                                          <a data-toggle="tab" href="#date-{{ forloop.counter }}">{{i.0|date:'D'}}</a>
                                      </li>
                                {% endif %}
                            {% endfor %}
                          
                      </ul>
                  </header>
                  <div class="panel-body">
                      <div class="tab-content">

                            {% for d in dates %}
                                {% if forloop.counter <= 5 %}
                                
                                    {% if forloop.counter == 1 %}
                                        <div id="date-{{ forloop.counter }}" class="tab-pane active">
                                    {% else %}
                                        <div id="date-{{ forloop.counter }}" class="tab-pane ">
                                    {% endif %}

                                        <div class="text-center mbot30">
                                              <p class="t-info"></p>
                                              <h3 class="timeline-title">{{ d.0|date:'l' }}&nbsp&nbsp{{ d.0|date:'F, d' }}</h3>
                                              <!--<p class="t-info">Here's what you need to know</p>-->

                                        </div>      
                                    {% comment %} 
                                    <div class="row">
                                        <div class='col-lg-12 col-sm-12'>
                                            {% if d.1 == 1 %}
                                                <div class="alert alert-warning fade in">   
                                                  <h4>
                                                      <i class="fa fa-ok-sign"></i>
                                                      Below Average Demand
                                                  </h4>
                                                  <p>Fewer or smaller events than average</p>
                                              </div>
                                            {% elif d.1 == 2 %}
                                              <div class="alert alert-success fade in">   
                                                  <h4>
                                                      <i class="fa fa-ok-sign"></i>
                                                      Average Demand
                                                  </h4>
                                                  <p>Normal number and size of events</p>
                                              </div>
                                            {% else %}
                                                <div class="alert alert-info fade in">   
                                                  <h4>
                                                      <i class="fa fa-ok-sign"></i>
                                                      Above Average Demand
                                                  </h4>
                                                  <p>We see more and bigger events than average</p>
                                              </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    {% endcomment %}
  
                                    <section class="panel">
                                          <header class="tab-bg">
                                              <ul class="nav nav-tabs nav-justified">
                                        
                                                <li class="active">
                                                    <a data-toggle="tab" href="#date-{{ forloop.counter }}-timeline" >
                                                        <i class="fa fa-calendar text-primary"></i>
                                                        Timeline View
                                                    </a>
                                                </li>
                                                
                                                <li class="">
                                                  <a data-toggle="tab" href="#date-{{ forloop.counter }}-map" id="map-tab-{{ forloop.counter }}">
                                                    <i class="fa fa-map-marker text-primary"></i>
                                                      Map View</a>
                                                </li>
                                                <li class="">
                                                  <a data-toggle="tab" href="#recent-activity-{{ forloop.counter }}">
                                                    <i class="fa fa-comment text-primary"></i>
                                                      Recent Activity
                                                    </a>
                                                </li>
                                              </ul>
                                          </header>
                                          
                                          <div class="panel-body">
                                              <div class="tab-content">
                                                  
                                                  <!-- this is the timeline view -->
                                                    <div id="date-{{ forloop.counter }}-timeline" class="tab-pane active">
                                                        
                                                        <div class="text-right">
                                                          <p>(click listings for detail)</p>
                                                          </br>
                                                        </div>      
                                                        

          
                                                                                            

                                                        <div class="timeline">
                                                            
                                                            {% for k, v in events_timeline.items %}
                                                                {% if k == d.0 %}
                                                                    {% for i in v %}
                                                                        
                                                                        <article class="timeline-item">
                                                                              <div class="timeline-desk">
                                                                                  <div class="panel">
                                                                                      
                                                                                      <div class="panel-body" >
                                                                            
                                                                                          <span class="arrow"></span>
                                                                                          <span class="timeline-icon green"></span> 
                                                                                          <span class="timeline-date">{{ i.pretty_EndTime }}</span>
                                                                                            
                                                                                            <a href="{% url 'event-detail' i.objectId %}">
                                                                                            <div class="row">

                                                                                              <div class="col-lg-9 col-xs-9">
                                                                                                <p>{{ i.Capacity }} expected</p>
                                                                                              </div>
                                                                                              <div class="col-lg-3 col-xs-3">
                                                                                                <i class="fa fa-angle-double-right"></i>
                                                                                              </div>
                                                                                            
                                                                                            </div>    
                                                                                            <p>{{ i.Address }}</p>
                                                                                            </a>
                                                                                              
                                                                                                               

                                                                                      </div>
                                                                                    
                                                                                  </div>
                                                                              </div>
                                                                          </article>
                                                                        {% comment %}
                                                                        {% if i.index == 1 %}
                                                                          
                                                                          <article class="timeline-item">
                                                                              <div class="timeline-desk">
                                                                                  <div class="panel">
                                                                                      
                                                                                      <div class="panel-body" >
                                                                            
                                                                                          <span class="arrow"></span>
                                                                                          <span class="timeline-icon red"></span> 
                                                                                          <span class="timeline-date">{{ i.pretty_EndTime }}</span>
                                                                                          
                                                                                            
                                                                                              <h1 class="red"><span><a href="{% url 'event-detail' i.objectId %}" class="red">{{ i.Capacity }} expected</a></span></h1>
                                                                                              <p><span><a href="{% url 'event-detail' i.objectId %}"  class="red">{{ i.Address }}</a></span></p>
                                                                                              </br>
                                                                                              <h1><span><a href="{% url 'event-detail' i.objectId %}"  class="red">
                                                                                                More  <i class="fa fa-angle-double-right"></i></a></span></h1>
                                                                                                               

                                                                                      </div>
                                                                                    
                                                                                  </div>
                                                                              </div>
                                                                          </article>
                                                                        {% endif %}

                                                                        {% if i.index == 2 %}
                                                                          
                                                                          <article class="timeline-item">
                                                                              <div class="timeline-desk">
                                                                                  <div class="panel">
                                                                                      
                                                                                      <div class="panel-body" >
                                                                            
                                                                                          <span class="arrow"></span>
                                                                                          <span class="timeline-icon green"></span> 
                                                                                          <span class="timeline-date">{{ i.pretty_EndTime }}</span>
                                                                                          
                                                                                            
                                                                                              <h1 class="green"><span><a href="{% url 'event-detail' i.objectId %}" class="green">{{ i.Capacity }} expected</a></span></h1>
                                                                                              <p><span><a href="{% url 'event-detail' i.objectId %}"  class="green">{{ i.Address }}</a></span></p>
                                                                                              </br>
                                                                                              <h1><span><a href="{% url 'event-detail' i.objectId %}"  class="green">
                                                                                                More  <i class="fa fa-angle-double-right"></i></a></span></h1>
                                                                                                               

                                                                                      </div>
                                                                                    
                                                                                  </div>
                                                                              </div>
                                                                          </article>
                                                                        
                                                                          
                                                                        {% endif %}

                                                                        {% if i.index == 3 %}
                                                                          <article class="timeline-item">
                                                                              <div class="timeline-desk">
                                                                                  <div class="panel">
                                                                                      
                                                                                      <div class="panel-body" >
                                                                            
                                                                                          <span class="arrow"></span>
                                                                                          <span class="timeline-icon blue"></span> 
                                                                                          <span class="timeline-date">{{ i.pretty_EndTime }}</span>
                                                                                          
                                                                                            
                                                                                              <h1 class="blue"><span><a href="{% url 'event-detail' i.objectId %}" class="blue">{{ i.Capacity }} expected</a></span></h1>
                                                                                              <p><span><a href="{% url 'event-detail' i.objectId %}"  class="blue">{{ i.Address }}</a></span></p>
                                                                                              </br>
                                                                                              <h1><span><a href="{% url 'event-detail' i.objectId %}"  class="blue">
                                                                                                More  <i class="fa fa-angle-double-right"></i></a></span></h1>
                                                                                                               

                                                                                      </div>
                                                                                    
                                                                                  </div>
                                                                              </div>
                                                                          </article>
                                                                          
                                                                        {% endif %}

                                                                        {% if i.index == 4 %}
                                                                          
                                                                          <article class="timeline-item">
                                                                              <div class="timeline-desk">
                                                                                  <div class="panel">
                                                                                      
                                                                                      <div class="panel-body" >
                                                                            
                                                                                          <span class="arrow"></span>
                                                                                          <span class="timeline-icon purple"></span> 
                                                                                          <span class="timeline-date">{{ i.pretty_EndTime }}</span>
                                                                                          
                                                                                            
                                                                                              <h1 class="red"><span><a href="{% url 'event-detail' i.objectId %}" class="purple">{{ i.Capacity }} expected</a></span></h1>
                                                                                              <p><span><a href="{% url 'event-detail' i.objectId %}"  class="purple">{{ i.Address }}</a></span></p>
                                                                                              </br>
                                                                                              <h1><span><a href="{% url 'event-detail' i.objectId %}"  class="purple">
                                                                                                More  <i class="fa fa-angle-double-right"></i></a></span></h1>
                                                                                                               

                                                                                      </div>
                                                                                    
                                                                                  </div>
                                                                              </div>
                                                                          </article>
                                                                        {% endif %}
                                                                        {% endcomment %}
                                                                      
                                                                    {% endfor %}
                                                                {% endif %}
                                                            {% endfor %}
                                                                
                                                        </div>
                                                        
                                                        <div class="clearfix">&nbsp;</div>


                                                    </div>
                                                
                                                    <!-- this loads the map view -->
                                                    <div id="date-{{ forloop.counter }}-map" class="tab-pane">
                                                            
                                                            <div class="row">
                                                              <div class="col-lg-12">
                                                                    <div id="gmap_marker-{{ forloop.counter }}" class="gmaps"></div> 
                                                              </div>
                                                              
                                                            </div>

                                                    </div>

                                                    <!-- this loads the recent activity view -->
                                                    <div id="recent-activity-{{ forloop.counter }}" class="tab-pane">
                                                            
                                                            <div class="row">
                                                              <div class="col-lg-12">
                                                                
                                                                  <div class="room-desk">
                                                                  
                                                                  
                                                                    {% for k, v in comments.items %}
                                                                      
                                                                      {% if k == d.0 %}
                                                                          {% if v %}        
                                                                            {% for i in v %}
                                                                            <div class="room-box">
                                                                              <h5 class="text-primary"><a href="{% url 'event-detail' i.event.objectId %}">{{ i.event.Capacity }} ppl - {{ i.event.Address }}</a></h5>
                                                                              <p>{{ i.message }}</p>
                                                                              <p><span class="text-muted">Posted: </span>
                                                                                <script>
                                                                                  var date = new Date({{ i.js_time }});
                                                                                  function formatAMPM(date) {
                                                                                    var hours = date.getHours();
                                                                                    var minutes = date.getMinutes();
                                                                                    var ampm = hours >= 12 ? 'pm' : 'am';
                                                                                    hours = hours % 12;
                                                                                    hours = hours ? hours : 12; // the hour '0' should be '12'
                                                                                    minutes = minutes < 10 ? '0'+minutes : minutes;
                                                                                    var strTime = hours + ':' + minutes + ' ' + ampm;
                                                                                    return strTime;
                                                                                  }
                                                                                  document.write(formatAMPM(date));
                                                                                </script>
                                                                               </p>
                                                                            </div>
                                                                              
                                                                            {% endfor %}
                                                                          {% else %}
                                                                          <div class="text-right">
                                                                            <p>No activity today yet.</p>
                                                                            
                                                                          </div>  

                                                                          {% endif %}
                                                                      {% endif %}
                                                                    {% endfor %}
                                                                </div>

                                                              </div>
                                                              
                                                            </div>

                                                    </div>
                                              </div>
                                        </div>
                                    </section>
                                                                 
                                   
                                           
                                   </div>       
                                {% endif %}
                            {% endfor %}
                      </div>
                  </div>
              </section>
            
               
          </section>
      </section>
      <!--main content end-->

      
{% endblock %}

{% block jsfoot %}
<!-- js placed at the end of the document so the pages load faster -->
   
    <script class="include" type="text/javascript" src={% static "flatlab/admin/js/jquery.dcjqaccordion.2.7.js" %}></script>
    <script src={% static "flatlab/admin/js/jquery.scrollTo.min.js" %}></script>
    <script src={% static "flatlab/admin/js/jquery.nicescroll.js" %} type="text/javascript"></script>
    <script src={% static "flatlab/admin/js/jquery.sparkline.js" %} type="text/javascript"></script>
    <script src={% static "flatlab/admin/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js" %}></script>
    <script src={% static "flatlab/admin/js/owl.carousel.js" %} ></script>
    <script src={% static "flatlab/admin/js/jquery.customSelect.min.js" %} ></script>
    <script src={% static "flatlab/admin/js/respond.min.js" %} ></script>
    <script src={% static "flatlab/admin/assets/jquery-ui/jquery-ui-1.10.1.custom.min.js" %} type="text/javascript"></script>
    <script src={% static "flatlab/admin/js/jquery.ui.touch-punch.min.js" %}></script>
    <script src={% static "flatlab/admin/js/respond.min.js" %} ></script>
    <script type="text/javascript" src={% static "flatlab/admin/assets/gritter/js/jquery.gritter.js" %}></script>
    <script type="text/javascript" src={% static "flatlab/admin/js/jquery.pulsate.min.js" %}></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script src={% static "flatlab/admin/js/gmaps.js" %}></script>
    
    <!--right slidebar-->
    <script src={% static "flatlab/admin/js/slidebars.min.js" %}></script>

    <!--common script for all pages-->
    <script src={% static "flatlab/admin/js/common-scripts.js" %}></script>
    <script src={% static "flatlab/admin/js/gmaps-scripts.js" %}></script>


<!--script for this page-->
    <script src={% static "flatlab/admin/js/sparkline-chart.js" %}></script>
    <script src={% static "flatlab/admin/js/easy-pie-chart.js" %}></script>
    <script src={% static "flatlab/admin/js/count.js" %}></script>
    <script src={% static "flatlab/admin/js/gritter.js" %} type="text/javascript"></script>
    <script src={% static "flatlab/admin/js/pulstate.js" %} type="text/javascript"></script>

       

  <script>
    
    var events = {{ events_maps|safe }}
    
    if (events.length >= 1) {
        $("#map-tab-1").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-1', events[0]);      
        }); 
    }
    if (events.length >= 2) {
        $("#map-tab-2").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-2', events[1]);      
        }); 
    }
    if (events.length >= 3) {
        $("#map-tab-3").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-3', events[2]);      
        }); 
    }
    if (events.length >= 4) {
        $("#map-tab-4").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-4', events[3]);      
        }); 
    }
    if (events.length >= 5) {
        $("#map-tab-5").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-5', events[4]);      
        }); 
    }
    if (events.length >= 6) {
        $("#map-tab-6").on('shown.bs.tab', function() {
            mapMarker('gmap_marker-6', events[4]);      
        }); 
    }
    
    // initializes maps
    var mapMarker = function (element, events) {
    
        var map = new GMaps({
            div: "#" + element,
            lat: events[0]["lat"],
            lng: events[0]["lng"],
            zoom: 11,
        });
        
        for (i = 0; i < events.length; i++) { 
                map.addMarker({
                lat: events[i]["lat"],
                lng: events[i]["lng"],
                title: events[i]["tag"],
                infoWindow: {
                    content: events[i]["tag"]
                }
            });
            
        }

    }

    
   

    $(document).ready(function() {
            
            
            // owl carousel
            $("#owl-demo").owlCarousel({
              navigation : true,
              slideSpeed : 300,
              paginationSpeed : 400,
              singleItem : true,
              autoPlay:true

          });
            
      });
    

      //custom select box

      $(function(){
          $('select.styled').customSelect();
      });
    
  </script>

{% endblock %}



